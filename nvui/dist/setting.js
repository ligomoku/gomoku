import { h } from 'snabbdom';
export function makeSetting(opts) {
    return {
        choices: opts.choices,
        get: () => cast(opts.storage.get()) || opts.default,
        set(v) {
            opts.storage.set(cast(v));
            return v;
        },
    };
}
export function renderSetting(setting, redraw) {
    const v = setting.get();
    return h('select', {
        hook: {
            insert(vnode) {
                vnode.elm.addEventListener('change', e => {
                    setting.set(cast(e.target.value));
                    redraw();
                });
            },
        },
    }, setting.choices.map(choice => {
        const [key, name] = choice;
        return h('option', {
            attrs: {
                value: '' + key,
                selected: key === v,
            },
        }, name);
    }));
}
function cast(v) {
    return v;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9zZXR0aW5nLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxDQUFDLEVBQVMsTUFBTSxVQUFVLENBQUM7QUFpQnBDLE1BQU0sVUFBVSxXQUFXLENBQUksSUFBYTtJQUMxQyxPQUFPO1FBQ0wsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPO1FBQ3JCLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxPQUFPO1FBQ3RELEdBQUcsQ0FBQyxDQUFJO1lBQ04sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbEMsT0FBTyxDQUFDLENBQUM7UUFDWCxDQUFDO0tBQ0YsQ0FBQztBQUNKLENBQUM7QUFFRCxNQUFNLFVBQVUsYUFBYSxDQUFJLE9BQW1CLEVBQUUsTUFBa0I7SUFDdEUsTUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQ3hCLE9BQU8sQ0FBQyxDQUNOLFFBQVEsRUFDUjtRQUNFLElBQUksRUFBRTtZQUNKLE1BQU0sQ0FBQyxLQUFLO2dCQUNULEtBQUssQ0FBQyxHQUF5QixDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRTtvQkFDOUQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUssQ0FBQyxDQUFDLE1BQTRCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztvQkFDNUQsTUFBTSxFQUFFLENBQUM7Z0JBQ1gsQ0FBQyxDQUFDLENBQUM7WUFDTCxDQUFDO1NBQ0Y7S0FDRixFQUNELE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFO1FBQzNCLE1BQU0sQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDO1FBQzNCLE9BQU8sQ0FBQyxDQUNOLFFBQVEsRUFDUjtZQUNFLEtBQUssRUFBRTtnQkFDTCxLQUFLLEVBQUUsRUFBRSxHQUFHLEdBQUc7Z0JBQ2YsUUFBUSxFQUFFLEdBQUcsS0FBSyxDQUFDO2FBQ3BCO1NBQ0YsRUFDRCxJQUFJLENBQ0wsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUNILENBQUM7QUFDSixDQUFDO0FBRUQsU0FBUyxJQUFJLENBQUksQ0FBTTtJQUNyQixPQUFPLENBQUMsQ0FBQztBQUNYLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBoLCBWTm9kZSB9IGZyb20gJ3NuYWJiZG9tJztcblxuZXhwb3J0IGludGVyZmFjZSBTZXR0aW5nPEE+IHtcbiAgY2hvaWNlczogQ2hvaWNlczxBPjtcbiAgZ2V0KCk6IEE7XG4gIHNldCh2OiBBKTogQTtcbn1cblxudHlwZSBDaG9pY2U8QT4gPSBbQSwgc3RyaW5nXTtcbnR5cGUgQ2hvaWNlczxBPiA9IEFycmF5PENob2ljZTxBPj47XG5cbmludGVyZmFjZSBPcHRzPEE+IHtcbiAgY2hvaWNlczogQ2hvaWNlczxBPjtcbiAgZGVmYXVsdDogQTtcbiAgc3RvcmFnZTogTGljaGVzc1N0b3JhZ2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlU2V0dGluZzxBPihvcHRzOiBPcHRzPEE+KTogU2V0dGluZzxBPiB7XG4gIHJldHVybiB7XG4gICAgY2hvaWNlczogb3B0cy5jaG9pY2VzLFxuICAgIGdldDogKCkgPT4gY2FzdDxBPihvcHRzLnN0b3JhZ2UuZ2V0KCkpIHx8IG9wdHMuZGVmYXVsdCxcbiAgICBzZXQodjogQSkge1xuICAgICAgb3B0cy5zdG9yYWdlLnNldChjYXN0PHN0cmluZz4odikpO1xuICAgICAgcmV0dXJuIHY7XG4gICAgfSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclNldHRpbmc8QT4oc2V0dGluZzogU2V0dGluZzxBPiwgcmVkcmF3OiAoKSA9PiB2b2lkKTogVk5vZGUge1xuICBjb25zdCB2ID0gc2V0dGluZy5nZXQoKTtcbiAgcmV0dXJuIGgoXG4gICAgJ3NlbGVjdCcsXG4gICAge1xuICAgICAgaG9vazoge1xuICAgICAgICBpbnNlcnQodm5vZGUpIHtcbiAgICAgICAgICAodm5vZGUuZWxtIGFzIEhUTUxTZWxlY3RFbGVtZW50KS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBlID0+IHtcbiAgICAgICAgICAgIHNldHRpbmcuc2V0KGNhc3Q8QT4oKGUudGFyZ2V0IGFzIEhUTUxTZWxlY3RFbGVtZW50KS52YWx1ZSkpO1xuICAgICAgICAgICAgcmVkcmF3KCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gICAgc2V0dGluZy5jaG9pY2VzLm1hcChjaG9pY2UgPT4ge1xuICAgICAgY29uc3QgW2tleSwgbmFtZV0gPSBjaG9pY2U7XG4gICAgICByZXR1cm4gaChcbiAgICAgICAgJ29wdGlvbicsXG4gICAgICAgIHtcbiAgICAgICAgICBhdHRyczoge1xuICAgICAgICAgICAgdmFsdWU6ICcnICsga2V5LFxuICAgICAgICAgICAgc2VsZWN0ZWQ6IGtleSA9PT0gdixcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBuYW1lXG4gICAgICApO1xuICAgIH0pXG4gICk7XG59XG5cbmZ1bmN0aW9uIGNhc3Q8VD4odjogYW55KTogVCB7XG4gIHJldHVybiB2O1xufVxuIl19